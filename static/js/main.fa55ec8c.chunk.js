(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,n){},57:function(e,t,n){e.exports=n(88)},62:function(e,t,n){},88:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(26),i=n.n(s),l=(n(62),n(16)),c=n(17),o=n(20),u=n(18),h=n(21),d=(n(39),function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"header-content"},r.a.createElement("h1",null,"Site Metrics"))}}]),t}(a.Component)),m=n(10),v=n(96),y=n(95),E=n(91),f=n(92),k=n(97),b=n(94),p=n(93),g=n(47),B=n.n(g),O=n(8),w=[{link:"https://kevinchoi.dev",label:"Site"},{link:"https://github.com/Kevin0115/metrics",label:"Github"},{link:"https://customer.elephantsql.com/instance",label:"Database"}],j=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={totalVisits:0,sessionIds:[],metricsById:{},reverseOrder:!1,visitsByEvent:[],visitsByMonth:[],visitsByWeek:[],json:null,username:"",password:"",authMessage:"",data:[],visitWeek:[],visitMonth:[],vWidth:0},n.reverseOrder=n.reverseOrder.bind(Object(m.a)(n)),n.renderEvents=n.renderEvents.bind(Object(m.a)(n)),n.renderMetricsCards=n.renderMetricsCards.bind(Object(m.a)(n)),n.handleResize=n.handleResize.bind(Object(m.a)(n)),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize),this.fetchSessionIds(),this.fetchVisitsByEvent()}},{key:"handleResize",value:function(){this.setState({vWidth:window.innerWidth})}},{key:"fetchSessionIds",value:function(){var e=this;fetch("https://ec2.kevnchoi.com/metric").then(function(e){return e.json()}).then(function(t){e.setState({sessionIds:t,totalVisits:t.length,metricsById:{}})}).catch(function(e){return console.log("Error: "+e)})}},{key:"fetchMetricsForId",value:function(e){var t=this;e in this.state.metricsById||fetch("https://ec2.kevnchoi.com/metric/session/"+e).then(function(e){return e.json()}).then(function(n){var a={events:n},r=t.state.metricsById;r[e]=a,t.setState({metricsById:r})}).catch(function(e){return console.log("Error: "+e)})}},{key:"fetchVisitsByEvent",value:function(){var e=this;fetch("https://ec2.kevnchoi.com/metric/chart").then(function(e){return e.json()}).then(function(t){e.setState({visitsByEvent:t.event_count,visitsByMonth:t.month_count,visitsByWeek:t.week_count})}).catch(function(e){return console.log("Error: "+e)})}},{key:"reverseOrder",value:function(){this.setState({sessionIds:this.state.sessionIds.reverse(),reverseOrder:!this.state.reverseOrder})}},{key:"renderReverseButton",value:function(){return this.state.reverseOrder?r.a.createElement("div",null,"\u21a5"):r.a.createElement("div",null,"\u21a7")}},{key:"renderRefreshButton",value:function(){return r.a.createElement("div",null,"\u21bb")}},{key:"renderMetricsCards",value:function(){var e=this;return this.state.sessionIds?this.state.sessionIds.map(function(t,n){return r.a.createElement(v.a,{bg:"light",style:{width:"60vw"},key:n},r.a.createElement(v.a.Header,{className:"header",style:{height:"36px",padding:"2px 4px"}},r.a.createElement(y.a.Toggle,{style:{padding:"2px"},as:E.a,variant:"link",eventKey:n.toString(),onClick:function(){return e.fetchMetricsForId(t.session_id)}},r.a.createElement(f.a,{variant:"primary",className:"event-count"},t.event_count),B()(t.ts).utcOffset(-8).format("MMM D, YYYY")),r.a.createElement("div",{className:"session-id"},t.session_id)),r.a.createElement(y.a.Collapse,{eventKey:n.toString()},r.a.createElement(k.a,null,e.renderEvents(t.session_id))))}):null}},{key:"renderEvents",value:function(e){if(this.state.metricsById[e])return this.state.metricsById[e].events.map(function(e,t){var n=B()(e.ts).utcOffset(-8).format("YYYY-MM-DD, h:mm A"),a=e.event_type.split("="),s="",i="";switch(a[0]){case"sessionStart":s="Started Session";break;case"linkVisit":s="Viewed ";break;case"navTo":s="Navigated to ";break;default:s="Unknown Event"}return a[1]&&(i=a[1]),r.a.createElement(k.a.Item,{key:t},r.a.createElement("p",{className:"event-desc"},s+i,": ",n))})}},{key:"renderLinks",value:function(){return w.map(function(e,t){return r.a.createElement("a",{key:t,href:e.link,rel:"noopener noreferrer",target:"_blank"},r.a.createElement(E.a,{variant:"outline-secondary",className:"link-item"},e.label))})}},{key:"renderChart",value:function(){return this.state.visitsByEvent?r.a.createElement(O.f,{margin:{bottom:80},xType:"ordinal",height:300,width:this.state.vWidth/2},r.a.createElement(O.d,null),r.a.createElement(O.a,null),r.a.createElement(O.g,null),r.a.createElement(O.e,{tickLabelAngle:-45}),r.a.createElement(O.c,{data:this.state.visitsByEvent})):null}},{key:"renderVisitsByMonth",value:function(){return this.state.visitsByMonth?r.a.createElement(O.f,{margin:{bottom:60},xType:"ordinal",height:300,width:this.state.vWidth/2,yDomain:[0,100]},r.a.createElement(O.d,null),r.a.createElement(O.a,null),r.a.createElement(O.g,null),r.a.createElement(O.e,null),r.a.createElement(O.b,{data:this.state.visitsByMonth})):null}},{key:"renderVisitsByWeek",value:function(){return this.state.visitsByWeek?r.a.createElement(O.f,{margin:{bottom:60},xType:"ordinal",height:300,width:this.state.vWidth/2,yDomain:[0,50]},r.a.createElement(O.d,null),r.a.createElement(O.a,null),r.a.createElement(O.g,null),r.a.createElement(O.e,null),r.a.createElement(O.b,{data:this.state.visitsByWeek})):null}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"body-content"},r.a.createElement(v.a,null,r.a.createElement(v.a.Body,null,r.a.createElement(b.a,{defaultActiveKey:"events"},r.a.createElement(p.a,{eventKey:"events",title:"Events"},r.a.createElement("div",{className:"event-list"},r.a.createElement("h4",{className:"event-header"},r.a.createElement(f.a,{variant:"secondary"},"Total Visits: ",this.state.totalVisits),r.a.createElement("div",{className:"reverse"},r.a.createElement(E.a,{variant:"outline-primary",style:{height:30,width:30,padding:0},onClick:function(){return e.reverseOrder()}},this.renderReverseButton()),r.a.createElement(E.a,{variant:"outline-primary",style:{height:30,width:30,padding:0},onClick:function(){return e.fetchSessionIds()}},this.renderRefreshButton()))),r.a.createElement(y.a,null,this.renderMetricsCards()))),r.a.createElement(p.a,{eventKey:"charts",title:"Charts"},r.a.createElement("div",{className:"charts"},r.a.createElement(v.a.Title,null,"Visits by Event Type"),this.renderChart(),r.a.createElement(v.a.Title,null,"Visits by Month"),this.renderVisitsByMonth(),r.a.createElement(v.a.Title,null,"Visits by Week"),this.renderVisitsByWeek())),r.a.createElement(p.a,{eventKey:"links",title:"Links"},r.a.createElement("div",{className:"links"},this.renderLinks()))))))}}]),t}(a.Component),M=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app-container"},r.a.createElement(d,null),r.a.createElement(j,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[57,1,2]]]);
//# sourceMappingURL=main.fa55ec8c.chunk.js.map