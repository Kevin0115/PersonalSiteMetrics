(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,n){},58:function(e,t,n){e.exports=n(89)},63:function(e,t,n){},89:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(26),i=n.n(s),c=(n(63),n(16)),l=n(17),o=n(20),d=n(18),h=n(21),u=(n(39),function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"header-content"},r.a.createElement("h1",null,"Site Metrics"))}}]),t}(a.Component)),v=n(57),m=n(9),y=n(98),f=n(97),E=n(92),k=n(93),b=n(99),p=n(96),g=n(94),B=n(95),O=n(47),w=n.n(O),M=n(8),j=[{link:"https://kevinchoi.dev",label:"Personal Site"},{link:"https://github.com/Kevin0115/PersonalSiteMetrics",label:"Github"},{link:"https://customer.elephantsql.com/instance",label:"Database"},{link:"https://react-bootstrap.github.io/components/alerts/",label:"React Bootstrap"},{link:"https://uber.github.io/react-vis/",label:"React-Vis"}],S=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(o.a)(this,Object(d.a)(t).call(this,e))).state={totalVisits:0,sessionIds:[],metricsById:{},reverseOrder:!1,visitsByEvent:[],visitsByMonth:[],visitsByWeek:[],visitsByDay:[],sortPeriod:"Monthly",username:"",password:"",authMessage:"",vWidth:0},n.reverseOrder=n.reverseOrder.bind(Object(m.a)(n)),n.renderEvents=n.renderEvents.bind(Object(m.a)(n)),n.renderMetricsCards=n.renderMetricsCards.bind(Object(m.a)(n)),n.handleResize=n.handleResize.bind(Object(m.a)(n)),n.handlePeriodSelect=n.handlePeriodSelect.bind(Object(m.a)(n)),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize),this.fetchSessionIds(),this.fetchVisitsByEvent()}},{key:"handleResize",value:function(){this.setState({vWidth:window.innerWidth})}},{key:"fetchSessionIds",value:function(){var e=this;fetch("https://ec2.kevnchoi.com/metric").then(function(e){return e.json()}).then(function(t){e.setState({sessionIds:t,totalVisits:t.length,metricsById:{}})}).catch(function(e){return console.log("Error: "+e)})}},{key:"fetchMetricsForId",value:function(e){var t=this;e in this.state.metricsById||fetch("https://ec2.kevnchoi.com/metric/session/"+e).then(function(e){return e.json()}).then(function(n){var a={events:n},r=t.state.metricsById;r[e]=a,t.setState({metricsById:r})}).catch(function(e){return console.log("Error: "+e)})}},{key:"fetchVisitsByEvent",value:function(){var e=this;fetch("https://ec2.kevnchoi.com/metric/chart").then(function(e){return e.json()}).then(function(t){e.setState({visitsByEvent:t.event_count,visitsByMonth:t.month_count,visitsByWeek:t.week_count,visitsByDay:t.day_count})}).catch(function(e){return console.log("Error: "+e)})}},{key:"reverseOrder",value:function(){this.setState({sessionIds:this.state.sessionIds.reverse(),reverseOrder:!this.state.reverseOrder})}},{key:"renderReverseButton",value:function(){return this.state.reverseOrder?r.a.createElement("div",null,"\u21a5"):r.a.createElement("div",null,"\u21a7")}},{key:"renderRefreshButton",value:function(){return r.a.createElement("div",null,"\u21bb")}},{key:"renderMetricsCards",value:function(){var e=this;return this.state.sessionIds?this.state.sessionIds.map(function(t,n){return r.a.createElement(y.a,{bg:"light",style:{width:"60vw"},key:n},r.a.createElement(y.a.Header,{className:"header",style:{height:"36px",padding:"2px 4px"}},r.a.createElement(f.a.Toggle,{style:{padding:"2px"},as:E.a,variant:"link",eventKey:n.toString(),onClick:function(){return e.fetchMetricsForId(t.session_id)}},r.a.createElement(k.a,{variant:"primary",className:"event-count"},t.event_count),w()(t.ts).utcOffset(-8).format("MMM D, YYYY")),r.a.createElement("div",{className:"session-id"},t.session_id)),r.a.createElement(f.a.Collapse,{eventKey:n.toString()},r.a.createElement(b.a,null,e.renderEvents(t.session_id))))}):null}},{key:"renderEvents",value:function(e){if(this.state.metricsById[e])return this.state.metricsById[e].events.map(function(e,t){var n=w()(e.ts).utcOffset(-8).format("YYYY-MM-DD, h:mm A"),a=e.event_type.split("="),s="",i="";switch(a[0]){case"sessionStart":s="Started Session";break;case"linkVisit":s="Viewed ";break;case"navTo":s="Navigated to ";break;default:s="Unknown Event"}return a[1]&&(i=a[1]),r.a.createElement(b.a.Item,{key:t},r.a.createElement("p",{className:"event-desc"},s+i,": ",n))})}},{key:"renderLinks",value:function(){return j.map(function(e,t){return r.a.createElement("a",{key:t,href:e.link,rel:"noopener noreferrer",target:"_blank"},r.a.createElement(E.a,{variant:"outline-secondary",className:"link-item"},e.label))})}},{key:"renderChart",value:function(){return this.state.visitsByEvent?r.a.createElement("div",{className:"chart"},r.a.createElement(M.f,{margin:{bottom:100},xType:"ordinal",height:300,width:this.state.vWidth/2},r.a.createElement(M.d,null),r.a.createElement(M.a,null),r.a.createElement(M.g,null),r.a.createElement(M.e,{tickLabelAngle:-45}),r.a.createElement(M.c,{data:this.state.visitsByEvent}))):null}},{key:"renderVisitsByPeriod",value:function(){var e=[],t=[];switch(this.state.sortPeriod){case"Weekly":e=this.state.visitsByWeek,t=[0,this.findMax(e)];break;case"Daily":e=this.state.visitsByDay,t=[0,this.findMax(e)];break;default:e=this.state.visitsByMonth,t=[0,this.findMax(e)]}return e?r.a.createElement("div",{className:"chart"},r.a.createElement(M.f,{margin:{bottom:80},xType:"ordinal",height:300,width:this.state.vWidth/2,yDomain:t},r.a.createElement(M.d,null),r.a.createElement(M.a,null),r.a.createElement(M.g,null),r.a.createElement(M.e,{tickLabelAngle:-45}),r.a.createElement(M.b,{data:e}))):null}},{key:"handlePeriodSelect",value:function(e){this.setState({sortPeriod:e.target.value})}},{key:"findMax",value:function(e){return e?1.3*Math.max.apply(Math,Object(v.a)(e.map(function(e){return e.y})).concat([0])):0}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"body-content"},r.a.createElement(y.a,null,r.a.createElement(y.a.Body,null,r.a.createElement(p.a,{defaultActiveKey:"events"},r.a.createElement(g.a,{eventKey:"events",title:"Events"},r.a.createElement("div",{className:"event-list"},r.a.createElement("h4",{className:"event-header"},r.a.createElement(k.a,{variant:"secondary"},"Total Visits: ",this.state.totalVisits),r.a.createElement("div",{className:"reverse"},r.a.createElement(E.a,{variant:"outline-secondary",style:{height:30,width:30,padding:0},onClick:function(){return e.reverseOrder()}},this.renderReverseButton()),r.a.createElement(E.a,{variant:"outline-secondary",style:{height:30,width:30,padding:0},onClick:function(){return e.fetchSessionIds()}},this.renderRefreshButton()))),r.a.createElement(f.a,null,this.renderMetricsCards()))),r.a.createElement(g.a,{eventKey:"charts",title:"Charts"},r.a.createElement("div",{className:"charts"},r.a.createElement(y.a.Title,null,"Visits by Event Type"),this.renderChart(),r.a.createElement(y.a.Title,null,this.state.sortPeriod," Visits"),r.a.createElement(B.a,{className:"period-select"},r.a.createElement(E.a,{variant:"secondary",onClick:this.handlePeriodSelect,value:"Monthly"},"Monthly"),r.a.createElement(E.a,{variant:"secondary",onClick:this.handlePeriodSelect,value:"Weekly"},"Weekly"),r.a.createElement(E.a,{variant:"secondary",onClick:this.handlePeriodSelect,value:"Daily"},"Daily")),this.renderVisitsByPeriod())),r.a.createElement(g.a,{eventKey:"links",title:"Links"},r.a.createElement("div",{className:"links"},this.renderLinks()))))))}}]),t}(a.Component),I=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"app-container"},r.a.createElement(u,null),r.a.createElement(S,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[58,1,2]]]);
//# sourceMappingURL=main.5ebbfc8e.chunk.js.map