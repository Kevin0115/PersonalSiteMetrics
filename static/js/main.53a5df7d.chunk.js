(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,a){},58:function(e,t,a){e.exports=a(89)},63:function(e,t,a){},89:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),i=a(27),r=a.n(i),c=(a(63),a(16)),l=a(17),o=a(21),h=a(18),d=a(22),u=(a(39),function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"header-content"},s.a.createElement("h1",null,"Site Metrics"))}}]),t}(n.Component)),v=a(57),m=a(9),y=a(98),f=a(97),E=a(92),k=a(93),p=a(99),b=a(100),g=a(96),O=a(94),B=a(95),M=a(47),w=a.n(M),S=a(8),j=[{link:"https://kevinchoi.dev",label:"Personal Site"},{link:"https://github.com/Kevin0115/PersonalSiteMetrics",label:"Github"},{link:"https://customer.elephantsql.com/instance",label:"Database"},{link:"https://react-bootstrap.github.io/components/alerts/",label:"React Bootstrap"},{link:"https://uber.github.io/react-vis/",label:"React-Vis"}],C=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(o.a)(this,Object(h.a)(t).call(this,e))).state={totalVisits:0,sessionIds:[],metricsById:{},reverseOrder:!1,pageOffset:0,visitsByEvent:[],visitsByMonth:[],visitsByWeek:[],visitsByDay:[],sortPeriod:"Monthly",username:"",password:"",authMessage:"",vWidth:0},a.reverseOrder=a.reverseOrder.bind(Object(m.a)(a)),a.renderEvents=a.renderEvents.bind(Object(m.a)(a)),a.renderMetricsCards=a.renderMetricsCards.bind(Object(m.a)(a)),a.handleResize=a.handleResize.bind(Object(m.a)(a)),a.handlePeriodSelect=a.handlePeriodSelect.bind(Object(m.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize),this.fetchSessionIds(),this.fetchVisitsByEvent()}},{key:"handleResize",value:function(){this.setState({vWidth:window.innerWidth})}},{key:"fetchSessionIds",value:function(){var e=this;fetch("https://ec2.kevnchoi.com/metric").then(function(e){return e.json()}).then(function(t){e.setState({sessionIds:t,totalVisits:t.length,metricsById:{}})}).catch(function(e){return console.log("Error: "+e)})}},{key:"fetchMetricsForId",value:function(e){var t=this;e in this.state.metricsById||fetch("https://ec2.kevnchoi.com/metric/session/"+e).then(function(e){return e.json()}).then(function(a){var n={events:a},s=t.state.metricsById;s[e]=n,t.setState({metricsById:s})}).catch(function(e){return console.log("Error: "+e)})}},{key:"fetchVisitsByEvent",value:function(){var e=this;fetch("https://ec2.kevnchoi.com/metric/chart").then(function(e){return e.json()}).then(function(t){e.setState({visitsByEvent:t.event_count,visitsByMonth:t.month_count,visitsByWeek:t.week_count,visitsByDay:t.day_count})}).catch(function(e){return console.log("Error: "+e)})}},{key:"reverseOrder",value:function(){this.setState({sessionIds:this.state.sessionIds.reverse(),reverseOrder:!this.state.reverseOrder})}},{key:"renderReverseButton",value:function(){return this.state.reverseOrder?s.a.createElement("div",null,"\u21a5"):s.a.createElement("div",null,"\u21a7")}},{key:"renderRefreshButton",value:function(){return s.a.createElement("div",null,"\u21bb")}},{key:"renderMetricsCards",value:function(){var e=this;return this.state.sessionIds?this.state.sessionIds.slice(0+10*this.state.pageOffset,10+10*this.state.pageOffset).map(function(t,a){return s.a.createElement(y.a,{bg:"light",style:{width:"60vw"},key:a},s.a.createElement(y.a.Header,{className:"header",style:{height:"36px",padding:"2px 4px"}},s.a.createElement(f.a.Toggle,{style:{padding:"2px"},as:E.a,variant:"link",eventKey:a.toString(),onClick:function(){return e.fetchMetricsForId(t.session_id)}},s.a.createElement(k.a,{variant:"primary",className:"event-count"},t.event_count),w()(t.ts).utcOffset(-8).format("MMM D, YYYY")),s.a.createElement("div",{className:"session-id"},t.session_id)),s.a.createElement(f.a.Collapse,{eventKey:a.toString()},s.a.createElement(p.a,null,e.renderEvents(t.session_id))))}):null}},{key:"renderEvents",value:function(e){if(this.state.metricsById[e])return this.state.metricsById[e].events.map(function(e,t){var a=w()(e.ts).utcOffset(-8).format("YYYY-MM-DD, h:mm A"),n=e.event_type.split("="),i="",r="";switch(n[0]){case"sessionStart":i="Started Session";break;case"linkVisit":i="Viewed ";break;case"navTo":i="Navigated to ";break;default:i="Unknown Event"}return n[1]&&(r=n[1]),s.a.createElement(p.a.Item,{key:t},s.a.createElement("p",{className:"event-desc"},i+r,": ",a))})}},{key:"renderLinks",value:function(){return j.map(function(e,t){return s.a.createElement("a",{key:t,href:e.link,rel:"noopener noreferrer",target:"_blank"},s.a.createElement(E.a,{variant:"outline-secondary",className:"link-item"},e.label))})}},{key:"renderChart",value:function(){if(!this.state.visitsByEvent)return null;var e=[0,this.findMax(this.state.visitsByEvent)];return s.a.createElement("div",{className:"chart"},s.a.createElement(S.f,{margin:{bottom:100,top:32},xType:"ordinal",height:400,width:this.state.vWidth/1.8,yDomain:e},s.a.createElement(S.d,null),s.a.createElement(S.a,null),s.a.createElement(S.g,null),s.a.createElement(S.e,{tickLabelAngle:-45}),s.a.createElement(S.c,{data:this.state.visitsByEvent})))}},{key:"renderVisitsByPeriod",value:function(){var e=[],t=[];switch(this.state.sortPeriod){case"Weekly":e=this.state.visitsByWeek,t=[0,this.findMax(e)];break;case"Daily":e=this.state.visitsByDay,t=[0,this.findMax(e)];break;default:e=this.state.visitsByMonth,t=[0,this.findMax(e)]}return e?s.a.createElement("div",{className:"chart"},s.a.createElement(S.f,{margin:{bottom:56,top:32},xType:"ordinal",height:360,width:this.state.vWidth/1.8,yDomain:t},s.a.createElement(S.d,null),s.a.createElement(S.a,null),s.a.createElement(S.g,null),s.a.createElement(S.e,{tickLabelAngle:-45}),s.a.createElement(S.b,{data:e}))):null}},{key:"handlePeriodSelect",value:function(e){this.setState({sortPeriod:e.target.value})}},{key:"findMax",value:function(e){return e?1.25*Math.max.apply(Math,Object(v.a)(e.map(function(e){return e.y})).concat([0])):0}},{key:"renderPagination",value:function(){var e=this;if(this.state.totalVisits<=10)return null;var t=[],a=Math.ceil(this.state.totalVisits/10);t.push(s.a.createElement(b.a.First,{key:"first",onClick:function(){return e.setState({pageOffset:0})}}));for(var n=function(a){t.push(s.a.createElement(b.a.Item,{key:a,onClick:function(){return e.setState({pageOffset:a})},active:e.state.pageOffset===a},a+1))},i=0;i<a;i++)n(i);return t.push(s.a.createElement(b.a.Last,{key:"last",onClick:function(){return e.setState({pageOffset:a-1})}})),t}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"body-content"},s.a.createElement(y.a,null,s.a.createElement(y.a.Body,null,s.a.createElement(g.a,{defaultActiveKey:"events"},s.a.createElement(O.a,{eventKey:"events",title:"Events"},s.a.createElement("div",{className:"event-list"},s.a.createElement("h4",{className:"event-header"},s.a.createElement(k.a,{variant:"secondary"},"Total Visits: ",this.state.totalVisits),s.a.createElement("div",{className:"reverse"},s.a.createElement(E.a,{variant:"outline-secondary",style:{height:30,width:30,padding:0},onClick:function(){return e.reverseOrder()}},this.renderReverseButton()),s.a.createElement(E.a,{variant:"outline-secondary",style:{height:30,width:30,padding:0},onClick:function(){return e.fetchSessionIds()}},this.renderRefreshButton()))),s.a.createElement(f.a,null,this.renderMetricsCards()),s.a.createElement(b.a,{className:"pagination"},this.renderPagination()))),s.a.createElement(O.a,{eventKey:"event-chart",title:"Chart (Events)"},s.a.createElement("div",{className:"charts"},s.a.createElement(y.a.Title,null,"Visits by Event Type"),this.renderChart())),s.a.createElement(O.a,{eventKey:"period-chart",title:"Chart (Time)"},s.a.createElement("div",{className:"charts"},s.a.createElement(y.a.Title,null,this.state.sortPeriod," Visits"),s.a.createElement(B.a,{className:"period-select"},s.a.createElement(E.a,{variant:"Monthly"===this.state.sortPeriod?"primary":"secondary",onClick:this.handlePeriodSelect,value:"Monthly"},"Monthly"),s.a.createElement(E.a,{variant:"Weekly"===this.state.sortPeriod?"primary":"secondary",onClick:this.handlePeriodSelect,value:"Weekly"},"Weekly"),s.a.createElement(E.a,{variant:"Daily"===this.state.sortPeriod?"primary":"secondary",onClick:this.handlePeriodSelect,value:"Daily"},"Daily")),this.renderVisitsByPeriod())),s.a.createElement(O.a,{eventKey:"links",title:"Links"},s.a.createElement("div",{className:"links"},this.renderLinks()))))))}}]),t}(n.Component),I=function(e){function t(){return Object(c.a)(this,t),Object(o.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"app-container"},s.a.createElement(u,null),s.a.createElement(C,null))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[58,1,2]]]);
//# sourceMappingURL=main.53a5df7d.chunk.js.map